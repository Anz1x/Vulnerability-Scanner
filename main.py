import ports
import time
import colorama
from colorama import Fore
import logging

colorama.init(autoreset=True)

print(Fore.GREEN + """

                     _      __      __    _          _____                                 
     /\             ( )     \ \    / /   | |        / ____|                                
    /  \   _ __  ___|/ ___   \ \  / /   _| |_ __   | (___   ___ __ _ _ __  _ __   ___ _ __ 
   / /\ \ | '_ \|_  / / __|   \ \/ / | | | | '_ \   \___ \ / __/ _` | '_ \| '_ \ / _ \ '__|
  / ____ \| | | |/ /  \__ \    \  /| |_| | | | | |  ____) | (_| (_| | | | | | | |  __/ |   
 /_/    \_\_| |_/___| |___/     \/  \__,_|_|_| |_| |_____/ \___\__,_|_| |_|_| |_|\___|_|                                                                                                                                                                                      

Vulnerability scanner made by Anz
Github: https://github.com/Anz1x
""" + Fore.RESET +
"""
______________________________________________________________________________________________
""")
time.sleep(0.75)

logging.basicConfig(level=logging.INFO, format="%(message)s" + Fore.YELLOW + "%(asctime)s", 
                    datefmt=time.strftime("%a, %d-%b-%Y %H:%M"))

targets_address = str(input(Fore.GREEN + "[+] Target: "))
port_range = int(input(Fore.GREEN + "[+] Port Range: "))
logging.info("\nStarting the scan on %s at " % (targets_address))
print("______________________________________________________________________________________________")
print("\n")


target = ports.PortScan(targets_address, port_range)
target.scan()

try:
    with open("vuln_banners.txt", "r") as file:
            count = 0
            for banner in target.banners:
                file.seek(0)
                for line in file.readlines():
                    if line.strip() in banner:
                        print(Fore.YELLOW + "[-] VULNERABLE: "+ Fore.RED + banner + " on port " + str(target.open_ports[count]))
                        count += 1

except:
    print("[-] Unable to open the file")       

print("______________________________________________________________________________________________")
print(Fore.GREEN + "\n[-] %s vulnerabilitie(s) found" % (count))